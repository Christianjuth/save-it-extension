function reloadOldUrls(o){$("#saved-tabs").children().remove();{var e=localStorage.savedTabs.split("^"),r=new Array;e.length}e.splice(e.length-1,e.length);for(var i=0;i<e.length;i++)e[i]=jQuery.parseJSON(e[i]),1==e[i].starred&&r.push(e[i]);e.sort(function(o,t){return o.url=o.url.replace("http://",""),o.url=o.url.replace("https://",""),o.url=o.url.replace("www.",""),soryBy="date",o[soryBy]<t[soryBy]?-1:o[soryBy]>t[soryBy]?1:0}),r.sort(function(o,t){return o.url=o.url.replace("http://",""),o.url=o.url.replace("https://",""),o.url=o.url.replace("www.",""),soryBy="date",o[soryBy]<t[soryBy]?-1:o[soryBy]>t[soryBy]?1:0});for(var i=0;i<e.length;i++){var u=e[e.length-(i+1)];if(0==u.starred){var a=$("nav > .title > h1")[$("nav > .title > h1").length-1],s=new Date(u.date);s=s.getMonth()+1+"-"+s.getDate()+"-"+s.getFullYear();var l="";if($(a).text()!=s?(l=$("<nav><div class='title'><h1>"+s+"</h1><h2>restore session</h2></div></nav>").appendTo("#saved-tabs"),$(l).children(".title").children("h2").click(function(){for(var o=$(this).parent().parent().children(".tab-container").children(".url"),t=0;t<o.length;t++){var e=$(o)[t],r=jQuery.parseJSON($(e).parent().attr("json"));restore(e,r,function(t){t==o.length-1&&updateUrls()},t)}})):l=$("#saved-tabs > nav")[$("nav > .title > h1").length-1],void 0!=u.favIconUrl)var c=u.favIconUrl;else var c=u.url.replace(/\.com.+/i,".com/favicon.ico");var f=(u.url,u.title.replace(/ is not available/,"")),b=$("<div json='"+JSON.stringify(u)+'\' class="tab-container"><img class="favicon" src="'+c+'"><div class="url">'+f+"</div><div class='right'><div class='star'>&#9734;</div><div class=\"remove\" >x</div></div></div>").appendTo(l);$(b).on("click",".remove",function(){var o=jQuery.parseJSON($(this).parent().parent().attr("json"));remove(this,o,function(){updateUrls()})}),$(b).on("click",".url",function(){var o=jQuery.parseJSON($(this).parent().attr("json"));restore(this,o,function(){updateUrls()})}),$(b).on("click",".star",function(){var o=jQuery.parseJSON($(this).parent().parent().attr("json"));star(this,o,function(){updateUrls()})})}}if(r.length>0){{$("<nav id='starred-tabs'><div class='title'><h1>Starred Tabs</h1><h2>restore starred</h2></div></nav>").prependTo("#saved-tabs")}for(i=0;i<r.length;i++){var u=r[r.length-(i+1)];if(void 0!=u.favIconUrl)var c=u.favIconUrl;else var c=u.url.replace(/\.com.+/i,".com/favicon.ico");var f=(u.url,u.title.replace(/ is not available/,"")),b=$("<div json='"+JSON.stringify(u)+'\' class="tab-container"><img class="favicon" src="'+c+'"><div class="url">'+f+"</div><div class='right'><div class='star'>&#9733;</div><div class=\"remove\" >x</div></div></div>").appendTo("#starred-tabs");$(b).unbind().on("click",".remove",function(){var o=jQuery.parseJSON($(this).parent().parent().attr("json"));remove(this,o,function(){updateUrls()})}),$(b).unbind().on("click",".url",function(){var o=jQuery.parseJSON($(this).parent().parent().attr("json"));restore(this,o,function(){updateUrls()})}),$(b).unbind().on("click",".star",function(){var o=jQuery.parseJSON($(this).parent().parent().attr("json"));unstar(this,o,function(){updateUrls()})})}}void 0!=o&&o()}function updateUrls(){localStorage.savedTabs="";for(var o=0;o<$(".tab-container").length;o++){var t=$(".tab-container")[$(".tab-container").length-(o+1)],e=jQuery.parseJSON($(t).attr("json"));e.date=new Date(e.date),localStorage.savedTabs=JSON.stringify(e)+"^"+localStorage.savedTabs}reloadOldUrls()}function remove(o,t,e){$(o).parent().parent().slideUp(200,"linear",function(){$(this).remove(),void 0!=e&&e()})}function restore(o,t,e,r){$(o).parent().slideUp(200,"linear",function(){var o=jQuery.parseJSON($(this).attr("json"));-1==o.url.indexOf("http")&&(o.url="http://"+o.url),chrome.tabs.create({url:o.url,pinned:o.pinned}),$(this).remove(),void 0!=e&&e(r)})}function star(o,t,e,r){t.starred=!0,$(o).parent().parent().attr("json",JSON.stringify(t)),void 0!=e&&e(r)}function unstar(o,t,e,r){t.starred=!1,$(o).parent().parent().attr("json",JSON.stringify(t)),void 0!=e&&e(r)}$(document).ready(function(){reloadOldUrls(function(){updateUrls()}),chrome.browserAction.onClicked.addListener(function(){setTimeout(function(){reloadOldUrls()},100)})});