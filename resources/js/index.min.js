function reloadOldUrls(e){$("#content").children().remove();{var t=localStorage.savedTabs.split("^"),n=new Array;t.length}t.splice(t.length-1,t.length);for(var i=0;i<t.length;i++)t[i]=jQuery.parseJSON(t[i]),1==t[i].starred&&n.push(t[i]);t.sort(function(e,r){return e.url=e.url.replace("http://",""),e.url=e.url.replace("https://",""),e.url=e.url.replace("www.",""),soryBy="date",e[soryBy]<r[soryBy]?-1:e[soryBy]>r[soryBy]?1:0}),n.sort(function(e,r){return e.url=e.url.replace("http://",""),e.url=e.url.replace("https://",""),e.url=e.url.replace("www.",""),soryBy="date",e[soryBy]<r[soryBy]?-1:e[soryBy]>r[soryBy]?1:0});for(var i=0;i<t.length;i++){var o=t[t.length-(i+1)];if(0==o.starred){var s=$("nav > .title > h1")[$("nav > .title > h1").length-1],l=new Date(o.date);l=l.getMonth()+1+"-"+l.getDate()+"-"+l.getFullYear();var c="";if($(s).text()!=l?(c=$("<nav><div class='title'><h1>"+l+"</h1><h2>restore session</h2></div></nav>").appendTo("#content"),$(c).children(".title").children("h2").click(function(){for(var e=$(this).parent().parent().children(".tab-container").children(".url"),r=0;r<e.length;r++){var t=$(e)[r],n=jQuery.parseJSON($(t).parent().attr("json"));restore(t,n,function(r){r==e.length-1&&updateUrls()},r)}})):c=$("#content > nav")[$("nav > .title > h1").length-1],void 0!=o.favIconUrl)var u=o.favIconUrl;else var u=o.url.replace(/\.com.+/i,".com/favicon.ico");var v=(o.url,o.title.replace(/ is not available/,"")),p=$("<div json='"+JSON.stringify(o)+'\' class="tab-container"><img class="favicon" src="'+u+'"><div class="url">'+v+"</div><div class='right'><div class='star'>&#9734;</div><div class=\"remove\" >x</div></div></div>").appendTo(c);$(p).on("click",".remove",function(){var e=jQuery.parseJSON($(this).parent().parent().attr("json"));remove(this,e,function(){updateUrls()})}),$(p).on("click",".url",function(){var e=jQuery.parseJSON($(this).parent().attr("json"));restore(this,e,function(){updateUrls()})}),$(p).on("click",".star",function(){var e=jQuery.parseJSON($(this).parent().parent().attr("json"));star(this,e,function(){updateUrls()})})}}if(n.length>0){{$("<nav id='starred-tabs'><div class='title'><h1>Starred Tabs</h1><h2>restore starred</h2></div></nav>").prependTo("#content")}for(i=0;i<n.length;i++){var o=n[n.length-(i+1)];if(void 0!=o.favIconUrl)var u=o.favIconUrl;else var u=o.url.replace(/\.com.+/i,".com/favicon.ico");var v=(o.url,o.title.replace(/ is not available/,"")),p=$("<div json='"+JSON.stringify(o)+'\' class="tab-container"><img class="favicon" src="'+u+'"><div class="url">'+v+"</div><div class='right'><div class='star'>&#9733;</div><div class=\"remove\" >x</div></div></div>").appendTo("#starred-tabs");$(p).unbind().on("click",".remove",function(){var e=jQuery.parseJSON($(this).parent().parent().attr("json"));remove(this,e,function(){updateUrls()})}),$(p).unbind().on("click",".url",function(){var e=jQuery.parseJSON($(this).parent().parent().attr("json"));restore(this,e,function(){updateUrls()})}),$(p).unbind().on("click",".star",function(){var e=jQuery.parseJSON($(this).parent().parent().attr("json"));unstar(this,e,function(){updateUrls()})})}}void 0!=e&&e()}function updateUrls(){localStorage.savedTabs="";for(var e=0;e<$(".tab-container").length;e++){var r=$(".tab-container")[$(".tab-container").length-(e+1)],t=jQuery.parseJSON($(r).attr("json"));t.date=new Date(t.date),localStorage.savedTabs=JSON.stringify(t)+"^"+localStorage.savedTabs}reloadOldUrls()}function remove(e,r,t){$(e).parent().parent().slideUp(200,"linear",function(){$(this).remove(),void 0!=t&&t()})}function restore(e,r,t,n){$(e).parent().slideUp(200,"linear",function(){var e=jQuery.parseJSON($(this).attr("json"));-1==e.url.indexOf("http")&&(e.url="http://"+e.url),chrome.tabs.create({url:e.url,pinned:e.pinned}),$(this).remove(),void 0!=t&&t(n)})}function star(e,r,t,n){r.starred=!0,$(e).parent().parent().attr("json",JSON.stringify(r)),void 0!=t&&t(n)}function unstar(e,r,t,n){r.starred=!1,$(e).parent().parent().attr("json",JSON.stringify(r)),void 0!=t&&t(n)}$(document).ready(function(){reloadOldUrls(function(){updateUrls()}),chrome.browserAction.onClicked.addListener(function(){setTimeout(function(){reloadOldUrls()},100)})});
